# Task 2

```sql
grant create table to U_DW_AUCTIONS;


CREATE MATERIALIZED VIEW U_DW_AUCTIONS.DAILY_SUBSTRICTIONS_REP
BUILD IMMEDIATE 
REFRESH COMPLETE  
ON COMMIT
AS 
SELECT TO_CHAR(MAKE_DTM, 'D')  AS DAY_WEEK,
        TO_CHAR(MAKE_DTM, 'DD')  AS DAY_MOUNTH,
        COUNT(*) COUNT
        FROM U_DW_AUCTIONS.T_BETS_F
        GROUP BY
            TO_CHAR(MAKE_DTM, 'D'),
            TO_CHAR(MAKE_DTM, 'DD')
        order by DAY_WEEK, DAY_MOUNTH;

SELECT * FROM U_DW_AUCTIONS.DAILY_SUBSTRICTIONS_REP ORDER BY DAY_WEEK, DAY_MOUNTH;
```


| DAY\_WEEK | DAY\_MOUNTH | COUNT |
| :--- | :--- | :--- |
| 2 | 01 | 34238 |

```sql
INSERT INTO  U_DW_AUCTIONS.T_BETS_F VALUES (2921, 120452, TO_DATE('01/08/2022', 'DD/MM/YYYY'), 123.45);
COMMIT;

SELECT * FROM U_DW_AUCTIONS.DAILY_SUBSTRICTIONS_REP ORDER BY DAY_WEEK, DAY_MOUNTH;
```

| DAY\_WEEK | DAY\_MOUNTH | COUNT |
| :--- | :--- | :--- |
| 2 | 01 | 34239 |
