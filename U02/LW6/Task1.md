# Task 1

```sql
SELECT 
    TSN.NAME,
    TS.ID_SUBSCRIPTIONS_NAME,  
    TS.RATE,
    TRUNC((RATE - FIRST_VALUE(RATE) OVER (PARTITION BY TS.ID_SUBSCRIPTIONS_NAME ORDER BY TS.START_DTM ROWS  BETWEEN 1 PRECEDING AND CURRENT ROW)) /
    (LAST_VALUE(RATE)  OVER (PARTITION BY TS.ID_SUBSCRIPTIONS_NAME ORDER BY TS.START_DTM ROWS  BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)-
        FIRST_VALUE(RATE) OVER (PARTITION BY TS.ID_SUBSCRIPTIONS_NAME ORDER BY TS.START_DTM ROWS  BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING))*100, 2)  PERCENT_DELT,
    TS.START_DTM,    
    TS.END_DTM
    
FROM
U_DW_SUBSTRICTIONS.T_SUBSCRIPTIONS TS
INNER JOIN 
U_DW_SUBSTRICTIONS.T_SUBSCRIPTIONS_NAME TSN
ON 
TS.ID_SUBSCRIPTIONS_NAME=TSN.ID_SUBSCRIPTIONS_NAME;


--NAME   |ID_SUBSCRIPTIONS_NAME|RATE                                   |PERCENT_DELT|START_DTM              |END_DTM                |
---------+---------------------+---------------------------------------+------------+-----------------------+-----------------------+
--START  |                    1|2.8368851775158034049535836480682719282|           0|2021-02-01 00:00:00.000|2021-07-31 00:00:00.000|
--START  |                    1|7.8130104337752200121152037835731961418|          77|2021-08-01 00:00:00.000|2021-10-01 00:00:00.000|
--START  |                    1|9.2991853017655681479327434219688033581|       22.99|2021-10-02 00:00:00.000|                       |
--MEDIUM |                    2|2.0030611476813292671748813280747630387|           0|2021-02-01 00:00:00.000|2021-07-31 00:00:00.000|
--MEDIUM |                    2| 2.768962793747863431593035927150517996|        6.88|2021-08-01 00:00:00.000|2021-10-01 00:00:00.000|
--MEDIUM |                    2|13.126019223183794991452528795186636028|       93.11|2021-10-02 00:00:00.000|                       |
--PREMIUM|                    3|3.4162646788493387297767985222177265997|           0|2021-02-01 00:00:00.000|2021-08-01 00:00:00.000|
--PREMIUM|                    3|3.4498437929927348874742914166895217786|        0.34|2021-08-01 00:00:00.000|2021-10-01 00:00:00.000|
--PREMIUM|                    3|4.2455314835772939907903570740655710866|        8.28|2021-10-02 00:00:00.000|2022-03-01 00:00:00.000|
--PREMIUM|                    3|13.020387693808161544567467031290278905|       91.36|2022-03-02 00:00:00.000|                       |
--YEAR   |                    4|10.359228431223212483453534514463380766|           0|2021-02-01 00:00:00.000|2021-08-01 00:00:00.000|
--YEAR   |                    4|16.951864369180125561509638966072913685|       90.62|2021-08-01 00:00:00.000|2021-10-01 00:00:00.000|
--YEAR   |                    4|17.634014859368362191988554916557768779|        9.37|2021-10-02 00:00:00.000|                       |

```